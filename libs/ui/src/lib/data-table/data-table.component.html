<mat-toolbar
  *ngIf="showToolbar"
  fxLayoutAlign="start center"
  style="background-color: white"
>
  <span>{{ metadata?.label }}</span>
  <span fxFlex></span>
  <button
    *ngFor="let action of actions"
    mat-icon-button
    (click)="onAction(action)"
  >
    <mat-icon>{{ action?.icon }}</mat-icon>
  </button>
</mat-toolbar>
<!-- {{ formGroup.value | json }} -->
<form [formGroup]="formGroup" autocomplete="off">
  <!--  -->
  <table
    class="mat-elevation-z0"
    mat-table
    [dataSource]="dataSource"
    formArrayName="data"
  >
    <ng-container *ngFor="let field of fieldMetadata" [matColumnDef]="field.id">
      <th mat-header-cell *matHeaderCellDef>{{ field.label }}</th>
      <td
        mat-cell
        *matCellDef="let row; let index = index"
        [formGroupName]="index"
        [style.width]="field.width?.lg"
      >
        <span [ngSwitch]="field.type">
          <ng-template ngSwitchCase="boolean">
            <ext-checkbox [formControlName]="field.id"> </ext-checkbox>
          </ng-template>

          <ng-template ngSwitchCase="enum">
            <ext-enum [formControlName]="field.id"></ext-enum>
          </ng-template>

          <ng-template ngSwitchCase="string">
            <ext-input-text [formControlName]="field.id"> </ext-input-text>
          </ng-template>

          <!-- <ng-template ngSwitchCase="embedded-object">
            <ext-embedded-object
              [control]="formGroup | formControl: field:index:arrayName"
            >
            </ext-embedded-object>
          </ng-template>

          <ng-template ngSwitchCase="embedded-object-list">
            <ext-embedded-object-list
              [control]="formGroup | formControl: field:index:arrayName"
            >
            </ext-embedded-object-list>
          </ng-template>

          <ng-template ngSwitchCase="action">
            <button mat-icon-button (click)="onAction(field.action!, index)">
              <mat-icon>{{ field?.icon }}</mat-icon>
            </button>
          </ng-template>
          <ng-template ngSwitchCase="icon">
            <ext-svg-icon
              [control]="formGroup | formControl: field:index:arrayName"
            >
            </ext-svg-icon>
          </ng-template>
         -->
          <!-- <ng-template ngSwitchCase="color">
            <ext-color-picker
              [fieldMetaData]="field"
              [control]="getControl(field.id, index)"
            >
            </ext-color-picker>
          </ng-template> -->
        </span>
      </td>
    </ng-container>

    <!-- <ng-container matColumnDef="save">
      <th mat-header-cell *matHeaderCellDef>Save</th>
      <tr *matCellDef="let row; let index = index">
        <button>Save</button>
      </tr>
    </ng-container> -->

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr
      mat-row
      *matRowDef="let row; let i = index; columns: displayedColumns"
    ></tr>
  </table>
</form>

<mat-paginator
  *ngIf="showPaginator"
  [pageSizeOptions]="[5, 10, 20]"
  showFirstLastButtons
>
</mat-paginator>
